# Flutter To Do List app

Приложение написано в рамках обучения в Школе Мобильной Разработки Яндекса 2023.

[Скачать](https://github.com/smirnovdevel/to_do_list/releases/download/v.1.0.0-todo/app-release.apk)

![Скриншот](https://github.com/smirnovdevel/to_do_list/assets/122177529/4dd42411-f173-4a12-9207-1cecf4db4577)

### Текущее состояние

Сверстаны 2 экрана. Главный, со списком задач и экран редактирования задачи. Написано API для получения, отправки и удаления задач с бэкенда. Добавлен функционал сохранения задач в локальную базу данных. При создании задачи, она отправляется в бэкенд и сохраняется в базе данных с фиксацией статуса отправки. Синхронизация списка задач выполняется при запуске. Для сохранения задач, интернет не требуется. При установке на другие устройства список задач будут синхронизирован.
<br><br>
Навигация переписана на Navigator 2.0 с использованием Riverpod для управлением стейтом.
<br><br>
Пример работы: в базе данных, в каждой задаче фиксируется, отправлена она на сервер или нет. В какой-то момент, он решает удалить одну из задач, но при этом у него отсутствует интернет. В таком случае, запись с задачей не удаляется из базы, но задача помечается как удалённая и такие задачи не отображаются в общем списке. В тот момент, когда пользователь запустит программу и произойдет синхронизация с сервером, все помеченные на удаление задачи в базе данных, будут удалены с сервера и при успехе удалены из базы данных.
<br><br>
Приложение поддерживает светлую и тёмную тему, согласно настроек телефона. А также два языка, русский и английский. В правой верхней части экрана, при наличии выполненных задач, появляется иконка по тапу на которую, отключается или включается видимось выполненных задач в общем списке. 
<br><br>
<img src="https://github.com/smirnovdevel/to_do_list/assets/122177529/ddd16adb-c1a4-47a6-b4b0-01507c2a357a" alt="drawing" width="400"/>

Управления состоянием в приложении реализовано с помощью пакета [Riverpod](https://pub.dev/packages/riverpod)
<br><br>
Локально данные сохраняются в базе с помощью пакета [sqflite](https://pub.dev/packages/sqflite), сетевой трафик на выбор, [dio](https://pub.dev/packages/dio) и [http](https://pub.dev/packages/http). Для обоих реализованы методы в слое `data`. По умолчанию используется http.
<br><br>
При свайпе задач вправо, задача отмечается выполненной, при свайпе влево удаляется из базы. Для удаление задачи требуется подтверждение
<br><br>
<img src="https://github.com/smirnovdevel/to_do_list/assets/122177529/6cd9e65e-fb51-4c1c-81b1-86c19b793343" alt="drawing" width="400"/>
<br><br>
Для хранения токена используется библиотека [envied](https://pub.dev/packages/envied) Поэтому,для полноценного тестирования необходимо в корневой директории создать файл `.env` с точкой впереди. В него положить свой токен в виде `TOKEN='ваш токен'` 
<br><br>
После этого, необходимо в консоли выполнить команду генерации `flutter pub run build_runner build`
<br><br>
Добавлена обработка ошибок, с выдачей сообщений и без. Например, при отсутсвии интернета будет выдано сообщение, один раз при запуске программы.
<br><br>
<img src="https://github.com/smirnovdevel/to_do_list/assets/122177529/1ecf2bb6-7cc4-4904-95e9-98392858804f" alt="drawing" width="400"/>
<br><br>
Написаны моки и тесты. Класс работы с сетью - HttpMock. Класс работы с базой данных скорректирован для состояния тестирования при помощи DI.
Unit тесты покрывают классы работы с сетью, работы с БД и бизнес логикой:
- local data source (создание, редактирование, удаление)
- remote data source (создание, редактирование, удаление)
- state holder (создание, редактирование, удаление)
<br><br>
Кроме unit-тестов написан интеграционный тест покрывающий сценарий добавления задачи. При этом соблюден принцип независимости окружения. Не используется записи в физическую базу данных, и нет обмена с реальным сервером. Т.е. для теста отправки даже не нужен интернет.
<br><br>
<img src="https://github.com/smirnovdevel/to_do_list/assets/122177529/8ca80802-bce0-4489-8f2f-3a9588f243b5" alt="drawing" width="400"/>
<br><br>
Добавлена поддержка диплинков
Для тестирования ссылки создающую новую задачу на эмуляторе android используется команда
<br>
`adb shell am start -W -a android.intent.action.VIEW -d app://mytodo.online/new` 
<br>
для ios: `xcrun simctl openurl booted app://mytodo.online/new`
<br><br>
Архитектура приложения построена на принципе Clean Architecture
<br><br>

<img src="https://github.com/smirnovdevel/to_do_list/assets/122177529/c847de1d-1dc9-4e29-ba82-67e763603701" alt="drawing" width="400"/>
